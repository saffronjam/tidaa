#include "p18F4520.inc"
    
    CONFIG  OSC = HS
    CONFIG  PWRT = OFF
    CONFIG  WDT = OFF
    CONFIG  PBADEN = OFF
    CONFIG  LVP = OFF
    
PRES	equ	0x00000
        
	org	0x00000
	BRA	MAIN
	
	org	0x00020
MAIN	RCALL	MINIT
LMLOOPO	RCALL	EDSHORT
	BSF	ADCON0,GO
LMLOOPI	BTFSC	ADCON0,DONE
	BRA	LMLOOPI
	MOVFF	ADRESH,PRES
	RCALL	EPUL
	RCALL	EDSHORT
	BRA	LMLOOPO
	BRA	$
	
EPUL	CLRF	PORTD
	
	MOVF	PRES,W
	ANDLW	0xE0
	ANDWF	PRES
	
	MOVLW	0xE0
	SUBWF	PRES,W
	BTFSC	STATUS,Z
	BSF	PORTD,7
	
	MOVLW	0xC0
	SUBWF	PRES,W
	BTFSC	STATUS,Z
	BSF	PORTD,6
	
	MOVLW	0xA0
	SUBWF	PRES,W
	BTFSC	STATUS,Z
	BSF	PORTD,5
	
	MOVLW	0x80
	SUBWF	PRES,W
	BTFSC	STATUS,Z
	BSF	PORTD,4
	
	MOVLW	0x60
	SUBWF	PRES,W
	BTFSC	STATUS,Z
	BSF	PORTD,3
	
	MOVLW	0x40
	SUBWF	PRES,W
	BTFSC	STATUS,Z
	BSF	PORTD,2
	
	MOVLW	0x20
	SUBWF	PRES,W
	BTFSC	STATUS,Z
	BSF	PORTD,1
	
	MOVLW	0x00
	SUBWF	PRES,W
	BTFSC	STATUS,Z
	BSF	PORTD,0
	RETURN
	
	
	;LPLLOOP	SUBWF	PRES,W
	;BTFSC	STATUS,Z
	;BSF	PRES,0
	;DECFSZ	WREG,W
	;BRA	LPLLOOP
	;MOVWF	PORTD
	
	
MINIT	CLRF	TRISA
	CLRF	TRISD
	BSF	TRISA,AN0
	BSF	TRISA,AN1
	BSF	TRISA,AN2
	BSF	PORTA,RA3
	CLRF	PORTD
	MOVLW	0x81
	MOVWF	ADCON0
	MOVLW	0xCE
	MOVWF	ADCON1
	RETURN
	
EDSHORT	MOVLW	0xFF
	MOVWF	0x0E0
LDLOOP	DECFSZ	0x0E0
	BRA	LDLOOP
	RETURN
	
	end